{% extends 'layout.html' %}
{% load static %}

{% block extra_css %}
<script src="https://cdn.tailwindcss.com"></script>
{% endblock %}

{% block content %}

<!-- HEADER -->
<header class="flex justify-between items-center px-6 py-3 border-b bg-white">
    <!-- Left: Date -->
    <span class="text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded-full">
        Today: {% now "F j, Y" %}
    </span>

    <!-- Right: Time + User -->
    <div class="flex items-center space-x-4">
        <div class="flex items-center space-x-2 text-sm text-gray-600">
            <i class="fas fa-clock"></i>
            <span>{% now "h:i A" %}</span>
        </div>
       <div
          class="w-8 h-8 !bg-gradient-to-r !from-[#4361ee] !to-[#3a0ca3] !text-white rounded-full flex items-center justify-center font-bold text-sm">
          {{ request.user.username.0|upper }}
      </div>

    </div>
</header>

<!-- PAGE -->
<div class="flex h-[calc(100vh-64px)]">

    <!-- SIDEBAR -->
    <aside class="w-96 border-r p-4 flex flex-col space-y-4">

        <!-- Clients header -->
        <div class="flex justify-between items-center">
            <h2 class="font-semibold text-lg">
                Clients ({{ client_num }})
            </h2>
            <button class="btn flex items-center gap-1 px-3 py-1 text-white rounded
            !bg-gradient-to-r !from-[#4361ee] !to-[#3a0ca3]
            hover:!from-[#3f5bdc] hover:!to-[#320b8f]" id="addNewClientDetailBtn">
              <i class="fas fa-plus-circle"></i> Add Client
            </button>

        </div>

        <!-- Search + Sort -->
        <div class="flex items-center gap-2">
            <div class="flex items-center gap-2 border rounded px-2 py-1 flex-1">
                <i class="fas fa-search text-gray-400"></i>
                <input
                    type="text"
                    id="clientDetailSearch"
                    placeholder="Search clients..."
                    class="w-full outline-none text-sm"
                >
            </div>

            <button class="btn btn-secondary whitespace-nowrap" id="sortClientBtn">
                <i class="fa-solid fa-sort"></i> Sort By
            </button>
        </div>

        <!-- Filters -->
        <div class="flex gap-2">
            <button class="btn btn-secondary flex-1 border border-gray-300 px-3 py-1 rounded" id="customers">Customer</button>
            <button class="btn btn-secondary flex- border border-gray-300 px-3 py-1 rounded" id="suppliers">Supplier</button>
            <button class="btn btn-secondary flex-1 border border-gray-300 px-3 py-1 rounded" id="allpayment">All Payment</button>
        </div>

        <!-- Client list -->
        <div class="flex-1 overflow-y-auto">
            <ul class="clientList space-y-2">
                <!-- dynamic clients here -->
            </ul>
        </div>

    </aside>
<main class="client-main flex-1 w-full bg-gray-50">

  <div id = "clientDetailContainer" class="p-6 space-y-3">

    <!-- ROW 1 -->
    <div class="flex items-start w-full">
      <div class="text-xl text-900 font-semibold" id = "clientName">
        {{ customer_info.name }}
      </div>

      <div class="ml-auto text-right">
        <div class="text-xl text-500 font-semibold" id="clientStatus">{%if customer_balance.remaining_amount == 0 %}
          Settled
          {%elif customer_balance.remaining_amount < 0 %}
          Payable
          {%elif customer_balance.remaining_amount > 0 %}
          Receivable
          {%endif%}
        </div>
       
      </div>
    </div>

    <!-- ROW 2 -->
    <div class="flex w-full text-gray-500">
      <div id="clientDetail">{%if customer_info.address%}
              {{ customer_info.address }}
              {%elif customer_info.phone%}
              {{customer_info.phone}}
            {%else%}
              ---
            {%endif%}</div>
        <div class="text-xl font-semibold text-emerald-600 ml-auto text-right" id="clientRemaining">{{ customer_balance.remaining_amount }}
        </div>
    </div>

    <!-- ROW 3 -->
    <div class="flex w-full items-center">
      <div class="flex space-x-2">
        <button class="btn flex items-center gap-1 border border-gray-300 px-3 py-1 rounded" id="clientEditBtn">
          <i class="fas fa-edit"></i> Edit
        </button>
        <button class="btn flex items-center gap-1 border border-gray-300 px-3 py-1 rounded" id="deleteClientBtn">
          <i class="fas fa-trash"></i> Delete
        </button>
        <button class="btn border border-gray-300 px-3 py-1 rounded"><i class="fas fa-file-pdf"></i> PDF</button>
      </div>

      <div class="ml-auto">
        <button class="btn !bg-gradient-to-r !from-[#4361ee] !to-[#3a0ca3] !text-white px-3 py-1 rounded hover:!from-[#3f5bdc] hover:!to-[#320b8f']">
  <i class="fas fa-bell"></i> Send Reminder
</button>

      </div>
    </div>
<!-- Divider line -->
<hr class="border-t border-gray-300 my-4">

<!-- Transaction Header Row -->
<div class="flex items-center w-full">

  <!-- Left: title -->
  <h2 class="text-lg font-semibold">
    Transaction (1)
  </h2>

  <!-- Right: actions -->
  <div class="ml-auto flex items-center gap-3">

    <div class="flex items-center gap-2 border rounded px-2 py-1">
      <i class="fas fa-search text-gray-400"></i>
      <input 
        type="text" 
        id="transactionSearchInput" 
        placeholder="Search transaction..."
        class="outline-none text-sm"
      >
    </div>

    <button class="btn border border-gray-300 px-3 py-1 rounded" id="transactionSortBtn">
      <i class="fa-solid fa-sort"></i> Sort By
    </button>

   <button
  class="btn px-3 py-1 text-white rounded
         !bg-gradient-to-r !from-[#4361ee] !to-[#3a0ca3]
         hover:!from-[#3f5bdc] hover:!to-[#320b8f]" id="addTransaction">
  <i class="fas fa-plus-circle"></i>
  Add Transaction
</button>

  </div>

</div>
<div class="transactionDetail w-full mt-3">
  <table class="w-full border text-sm" id="transactionTable">
    <thead class="bg-gray-100">
      <tr>
        <th class="p-2 text-left">Type</th>
        <th class="p-2 text-left">Date</th>
        <th class="p-2 text-left">Total</th>
        <th class="p-2 text-left">Status</th>
        <th class="p-2 text-left">Balance</th>
        <th class="p-2 text-left">Remarks</th>
      </tr>
    </thead>

    <tbody id="clientTransactionTableBody">
    </tbody>
  </table>
</div>


{% comment %} payment transactions {% endcomment %}
<div
  id="paymentTransactions"
  class="absolute hidden mt-0.5 z-50 w-44
         bg-white border border-gray-200
         rounded-lg shadow-lg
         py-1 "
>
  <ul class="text-sm text-gray-700">
    <li class="px-4 py-2 hover:bg-gray-100 cursor-pointer" id= "salesInvoice">
      Sales Invoice
    </li>
    <li class="px-4 py-2 hover:bg-gray-100 cursor-pointer" id= "paymentIn">
      Payment In
    </li>
    <li class="px-4 py-2 hover:bg-gray-100 cursor-pointer" id= "paymentOut">
      Payment Out
    </li>
    <li class="px-4 py-2 hover:bg-gray-100 cursor-pointer" id= "adjustBalance">
      Adjust Balance
    </li>
  </ul>
</div>

{% comment %} payment in modal {% endcomment %}
<!-- Payment In Modal -->
<div id="paymentModal"
     class="fixed inset-0 bg-black/40 flex items-center justify-center z-50 hidden">

  <!-- Modal -->
  <div
  class="bg-white w-full max-w-3xl rounded-lg shadow-lg p-6"
  onclick="event.stopPropagation()"
>

    <!-- Header -->
    <div class="flex items-center justify-between mb-6">

      <h2 class="text-xl font-semibold text-gray-800" id="paymentHeader">
        Add Payment In
      </h2>

      <!-- Close Button -->
      <button
        type="button"
        class="w-8 h-8 flex items-center justify-center rounded-full
               text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition"
        aria-label="Close"
      >
        âœ•
      </button>

    </div>

    <!-- Body -->
    <div class="space-y-5">

      <!-- First Row -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-gray-600 mb-1">Receipt Number</label>
          <input
            type="text"
            placeholder="ID from DB"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="receiptNumber">
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Date</label>
          <input
            type="date"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="paymentInDate">
        </div>
      </div>

      <!-- Second Row -->
      <div>
        <label class="block text-sm text-gray-600 mb-1">Party Name</label>
        <input
          type="text"
          class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="partyName">
      </div>

      <!-- Third Row -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-gray-600 mb-1" id="amountInputLabel">Received Amount</label>
          <input
            type="text"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id= "amountInput">
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Payment Method</label>
          <input
            type="text"
            placeholder="Cash"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none">
        </div>
      </div>

      <!-- Fourth Row -->
      <div>
        <label class="block text-sm text-gray-600 mb-1">Remarks</label>
        <input
          type="text"
          class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="paymentInRemarks">
      </div>

    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-3 mt-8 pt-4 border-t">

      <button
        class="px-4 py-2 border border-gray-300 rounded-md text-sm
               text-gray-700 hover:bg-gray-100 transition" id ="saveAndNew">
        Save & New
      </button>

      <button
        class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm
               hover:bg-blue-700 transition" id="savePaymentIn">
        Save Payment In
      </button>
      <button
        class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm
               hover:bg-blue-700 transition" id="savePaymentOut">
        Save Payment Out
      </button>


    </div>

  </div>
</div>


  </div>
 {% comment %} for empty page after deletion {% endcomment %}
<div id="emptyState" class="empty-state hidden flex flex-col items-center justify-center h-full text-center text-gray-500 px-8">
            <div class="illustration mb-6 opacity-50">
                <div class="w-24 h-24 bg-gray-200 rounded-lg mx-auto"></div>
                <div class="w-40 h-3 bg-gray-200 rounded mt-4 mx-auto"></div>
                <div class="w-32 h-3 bg-gray-200 rounded mt-3 mx-auto"></div>
            </div>
            <h2 class="text-xl font-medium mb-2">No clients found</h2>
            <p class="text-sm">Click any client to see their transactions</p>
</div> 

<div id="notFound" class="not-found hidden flex flex-col items-center justify-center h-full text-center text-gray-600">
            <div class="icon text-6xl mb-4">ðŸ¤–</div>
            <h1 class="text-3xl font-semibold mb-3">Not Found</h1>
            <p class="text-base mb-2">Oops! Page not Found!</p>
            <p class="text-sm max-w-md">The page you're looking for doesn't exist anymore or has been moved or archived.</p>
        </div>


</main>
 
<!-- Modal Background -->
<div id="adjustBalanceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
  <!-- Modal Container -->
  <div class="bg-white rounded-xl shadow-lg w-4/5 max-w-3xl p-8 relative">

    <!-- Header with Close Button -->
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-semibold text-gray-800">Adjust Balance</h2>
      <!-- Cross Button -->
      <button id="closeAdjustBalance" class="text-gray-500 hover:text-gray-700 text-2xl font-bold">&times;</button>
    </div>

    <!-- Adjustment Type Label -->
    <div class="mb-2">
      <p class="text-gray-600">Adjustment Type</p>
    </div>

    <!-- Add/Reduce Buttons -->
   
      <div class="flex space-x-4 mb-6">
  <button id="addBalance" class="px-4 py-2 rounded border border-gray-300 bg-gray-200 text-black">Add Balance</button>
  <button id="reduceBalance" class="px-4 py-2 rounded border border-gray-300 bg-gray-200 text-black">Reduce Balance</button>
</div>
   

    <!-- Adjustment Amount & As of Date Labels -->
    <div class="flex justify-between mb-1">
      <label class="text-gray-600">Adjustment Amount</label>
      <label class="text-gray-600">As of Date</label>
    </div>

    <!-- Adjustment Amount & Date Inputs -->
    <div class="flex justify-between mb-6">
      <input type="number" class="border rounded px-3 py-2 w-5/12" placeholder="Amount" id="adjustmentAmount">
      <input type="date" class="border rounded px-3 py-2 w-5/12" id="adjustmentDate">
    </div>

    <!-- Remarks Label -->
    <div class="mb-1">
      <label class="text-gray-600">Remarks</label>
    </div>

    <!-- Remarks Input -->
    <div class="mb-6">
      <input type="text" class="border rounded px-3 py-2 w-full" placeholder="Remarks" id ="adjustmentRemarks">
    </div>

    <!-- Current Balance Label & Input (Right Aligned, No Border) -->
    <div class="flex justify-between items-center mb-3">
      <label class="text-gray-600">Current Balance</label>
      <input type="number" class="text-right w-1/3 bg-transparent text-gray-800" placeholder="0" readonly id="currentBalance">
    </div>

    <!-- Adjusted Balance Label & Input (Right Aligned, No Border) -->
    <div class="flex justify-between items-center mb-6">
      <label class="text-gray-600">Adjusted Balance</label>
      <input type="number" class="text-right w-1/3 bg-transparent text-gray-800" placeholder="0" readonly id="adjustedBalance">
    </div>

    <!-- Action Buttons (Right Aligned) -->
    <div class="flex justify-end space-x-2">
      <button id="cancelAdjustBalance" class="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300">Cancel</button>
      <button class="btn px-3 py-1 text-white rounded
         !bg-gradient-to-r !from-[#4361ee] !to-[#3a0ca3]
         hover:!from-[#3f5bdc] hover:!to-[#320b8f]" id="balanceAdjust">Confirm Adjustment</button>
    </div>

  </div>
</div>




</div>
<!--opening balance edit modal-->
<div id="openingBalanceModal"
     class="fixed inset-0 bg-black/40 flex items-center justify-center hidden">

  <!-- Modal Box -->
  <div class="bg-white w-[380px] rounded-lg p-6 space-y-4">

    <!-- Row 1 -->
<div class="flex items-center justify-between">
  <h2 class="text-lg font-semibold text-gray-800">
    Edit Opening Balance
  </h2>

  <button
    id="closeOpeningBalanceModal"
    class="text-gray-400 hover:text-gray-700 text-xl leading-none">
    &times;
  </button>
</div>

    <!-- Row 2 -->
    <div class="grid grid-cols-2 text-sm font-medium text-gray-600">
      <label>Opening Balance</label>
      <label>Date</label>
    </div>

    <!-- Row 3 -->
    <div class="grid grid-cols-2 gap-3">
      <input
        type="number"
        id="openingAmount"
        readonly
        class="border rounded px-3 py-2 text-sm bg-gray-100 focus:outline-none"
      />

      <input
        type="date"
        id="openingDate"
        readonly
        class="border rounded px-3 py-2 text-sm bg-gray-100 focus:outline-none"
      />
    </div>

    <!-- Row 4 -->
<label class="text-sm font-medium text-gray-700 block">
  Opening Balance Type
</label>

<!-- Row 5 -->
<div class="flex gap-3 justify-start">
  <button
    id="receive"
    disabled
    class="type-btn border border-black px-4 py-2 rounded text-sm text-black disabled:opacity-50"
    data-type="TORECEIVE">
    To Receive
   
  </button>

  <button
    id="give"
    disabled
    class="type-btn border border-black px-4 py-2 rounded text-sm text-black disabled:opacity-50"
    data-type="TOGIVE">
    To Give
  </button>
</div>

<!-- Row 6 -->
<div class="flex justify-end gap-2 pt-4">
  <button
    class="border border-black px-4 py-2 rounded text-sm text-black" id ="deleteOpening">
    Delete
  </button>

  <button
    id="editBtn"
    class="border border-black px-4 py-2 rounded text-sm text-black">
    Edit Details
  </button>
  <button
    class="border border-black px-4 py-2 rounded text-sm text-black hidden" id="cancelOpeningEdit">
    Cancel
  </button>

  <button
   
    class="border border-black px-4 py-2 rounded text-sm text-black hidden" id = "updateOpening">
    Update
  </button>
</div>


  </div>
</div>
<!-- UpdatePayment Modal -->
<div id="updatePaymentModal"
     class="fixed inset-0 bg-black/40 flex items-center justify-center z-50 hidden">

  <!-- Modal -->
  <div
  class="bg-white w-full max-w-3xl rounded-lg shadow-lg p-6"
  onclick="event.stopPropagation()"
>

    <!-- Header -->
    <div class="flex items-center justify-between mb-6">

      <h2 class="text-xl font-semibold text-gray-800" id="editHeader">
        Edit Payment In
      </h2>

      <!-- Close Button -->
      <button
        type="button"
        class="w-8 h-8 flex items-center justify-center rounded-full
               text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition"
        aria-label="Close" id="closeUpdate"
      >
        âœ•
      </button>

    </div>

    <!-- Body -->
    <div class="space-y-5">

      <!-- First Row -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-gray-600 mb-1">Receipt Number</label>
          <input
            type="text"
            placeholder="ID from DB"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="updateReceiptNumber" readonly>
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Date</label>
          <input
            type="date"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="updatePaymentInDate" readonly>
        </div>
      </div>

      <!-- Second Row -->
      <div>
        <label class="block text-sm text-gray-600 mb-1">Party Name</label>
        <input
          type="text"
          class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="updatePartyName" readonly>
      </div>

      <!-- Third Row -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-gray-600 mb-1" id="amountInputLabel">Received Amount</label>
          <input
            type="text"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id= "updateAmountInput" readonly>
        </div>

        <div>
          <label class="block text-sm text-gray-600 mb-1">Payment Method</label>
          <input
            type="text"
            placeholder="Cash"
            class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" readonly>
        </div>
      </div>

      <!-- Fourth Row -->
      <div>
        <label class="block text-sm text-gray-600 mb-1">Remarks</label>
        <input
          type="text"
          class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none" id="updatePaymentRemarks" readonly>
      </div>

    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-3 mt-8 pt-4 border-t">
      <button
        class="px-4 py-2 border border-gray-300 rounded-md text-sm
               text-gray-700 hover:bg-gray-100 transition" id = "deletePaymentIn">
        Delete
      </button>
      <button
        class="px-4 py-2 border border-gray-300 rounded-md text-sm
               text-gray-700 hover:bg-gray-100 transition" id= "printPaymentIn">
        Print
      </button>
      <button
        class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm
               hover:bg-blue-700 transition" id="editPaymentIn">
        Edit Details
      </button>
      <button
        class="px-4 py-2 border border-gray-300 rounded-md text-sm
               text-gray-700 hover:bg-gray-100 transition hidden" id = "cancelEditPaymentIn">
        Cancel
      </button>
      <button
        class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm
               hover:bg-blue-700 transition hidden" id="updatePaymentIn">
        Update Payment In
      </button>

      <button
        class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm
               hover:bg-blue-700 transition hidden" id="updatePaymentOut">
        Update Payment Out
      </button>

    </div>

  </div>
</div>


  </div>

<!--update adjust balance modal-->
<div id="EditAdjustModal"
     class="fixed inset-0 bg-black/40 flex items-center justify-center hidden">

  <!-- Modal Box -->
  <div class="bg-white w-[380px] rounded-lg p-6 space-y-4">

    <!-- Row 1 -->
<div class="flex items-center justify-between">
  <h2 class="text-lg font-semibold text-gray-800">
    Adjust Balance
  </h2>

  <button
    id="closeEditAdjustModal"
    class="text-gray-400 hover:text-gray-700 text-xl leading-none">
    &times;
  </button>
</div>

    <!-- Row 2 -->
    <div class="grid grid-cols-2 text-sm font-medium text-gray-600">
      <label>Adjustment Amount</label>
      <label>As of Date</label>
    </div>

    <!-- Row 3 -->
    <div class="grid grid-cols-2 gap-3">
      <input
        type="number"
        id="adjustAmount"
        readonly
        class="border rounded px-3 py-2 text-sm bg-gray-100 focus:outline-none"
      />

      <input
        type="date"
        id="adjustDate"
        readonly
        class="border rounded px-3 py-2 text-sm bg-gray-100 focus:outline-none"
      />
    </div>

    <!-- Row 4 -->
<div>
        <label class="block text-sm text-gray-600 mb-1">Remarks</label>
        <input
          type="text"
          class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none " id="adjustRemarks" readonly>
      </div>

    <div class = "hidden" id ="adjust-current-balance">
    <div class="flex justify-between items-center mb-3">
      <label class="text-gray-600">Current Balance</label>
      <input type="number" class="text-right w-1/3 bg-transparent text-gray-800" placeholder="0" readonly id="currentRemaining">
    </div>

   
    <div class="flex justify-between items-center mb-6">
      <label class="text-gray-600">Adjusted Balance</label>
      <input type="number" class="text-right w-1/3 bg-transparent text-gray-800" placeholder="0" readonly id="adjustedRemaining">
    </div>
  </div>

<!-- Row 6 -->
<div class="flex justify-end gap-2 pt-4">
  <button
    class="border border-black px-4 py-2 rounded text-sm text-black" id ="deleteAdjust">
    Delete
  </button>

  <button
    id="editAdjust"
    class="border border-black px-4 py-2 rounded text-sm text-black">
    Edit Details
  </button>
  <button
    class="border border-black px-4 py-2 rounded text-sm text-black hidden" id="cancelEditAdjust">
    Cancel
  </button>

  <button
   
    class="border border-black px-4 py-2 rounded text-sm text-black hidden" id = "adjustAddAmount">
    Update Adjustment
  </button>
  <button
   
    class="border border-black px-4 py-2 rounded text-sm text-black hidden" id = "adjustReduceAmount">
    Update Adjustment
  </button>
</div>


  </div>
</div>

{% include "website/modal/client_add_modal.html" %}
{% include "website/invoice_modal.html" %}
{% comment %} {% include "website/create_invoice.html" %} {% endcomment %}
{% endblock %}
{% block extra_js %}
<script>
// Simple and safe data structure
window.djangoData = {
    products: {{ product|safe }},
    product_cat: {{ product_cat|safe }},
    clients: {{ customer|safe }},
    invoices: {{ invoices|safe }},
    csrfToken: "{{ csrf_token }}",
    active_tab: "{{ active_tab|default:'dashboard' }}"
};

// SAFETY CHECK
if (typeof window.djangoData === 'undefined') {
    window.djangoData = {
        products: [],
        product_cat: [],
        clients: [],
        invoices: {{ invoices|safe }},
        csrfToken: "{{ csrf_token }}",
        active_tab: "{{ active_tab|default:'dashboard' }}"
    };
}

console.log('Active tab:', window.djangoData.active_tab);
</script>

<script>const csrfToken = "{{ csrf_token }}";</script>
<script type="module" src="{%static 'js/client_detail.js'%}"></script>
<script type="module" src="{%static 'js/client.js'%}"></script>
<script type="module" src="{% static 'js/main.js' %}"></script>
<script type="module" src="{% static 'js/event.js' %}"></script>
{% endblock %}

